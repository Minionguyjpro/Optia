From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Hugo Manrique <hugmanrique@gmail.com>
Date: Mon, 16 Jul 2018 12:42:20 +0200
Subject: [PATCH] Avoid item merge if stack size above max stack size


diff --git a/src/main/java/net/minecraft/world/entity/item/EntityItem.java b/src/main/java/net/minecraft/world/entity/item/EntityItem.java
index de11fd9772f30ac72c3ca52ec4efc3fef4091425..4cfe3475fa913cd46116f13ea8ed9caf5372a41a 100644
--- a/src/main/java/net/minecraft/world/entity/item/EntityItem.java
+++ b/src/main/java/net/minecraft/world/entity/item/EntityItem.java
@@ -209,6 +209,10 @@ public class EntityItem extends Entity {
 
     private void mergeNearby() {
         if (this.z()) {
+            // Paper start - avoid item merge if stack size above max stack size
+            ItemStack stack = getItemStack();
+            if (stack.getCount() >= stack.getMaxStackSize()) return;
+            // Paper end
             // Spigot start
             double radius = world.spigotConfig.itemMerge;
             List<EntityItem> list = this.world.a(EntityItem.class, this.getBoundingBox().grow(radius, radius, radius), (entityitem) -> {
